package com.algorithm.contest.weeklycontest240;

/**
 * https://leetcode-cn.com/problems/maximum-distance-between-a-pair-of-values/
 * #1855. 下标对中的最大距离
 *
 *
 * 给你两个 非递增 的整数数组 nums1​​​​​​ 和 nums2​​​​​​ ，数组下标均 从 0 开始 计数。
 *
 * 下标对 (i, j) 中 0 <= i < nums1.length 且 0 <= j < nums2.length 。如果该下标对同时满足 i <= j 且 nums1[i] <= nums2[j] ，则称之为 有效 下标对，该下标对的 距离 为 j - i​​ 。​​
 *
 * 返回所有 有效 下标对 (i, j) 中的 最大距离 。如果不存在有效下标对，返回 0 。
 *
 * 一个数组 arr ，如果每个 1 <= i < arr.length 均有 arr[i-1] >= arr[i] 成立，那么该数组是一个 非递增 数组。
 *
 * 示例 1：
 * 输入：nums1 = [55,30,5,4,2], nums2 = [100,20,10,10,5]
 * 输出：2
 * 解释：有效下标对是 (0,0), (2,2), (2,3), (2,4), (3,3), (3,4) 和 (4,4) 。
 * 最大距离是 2 ，对应下标对 (2,4) 。
 *
 * 示例 2：
 * 输入：nums1 = [2,2,2], nums2 = [10,10,1]
 * 输出：1
 * 解释：有效下标对是 (0,0), (0,1) 和 (1,1) 。
 * 最大距离是 1 ，对应下标对 (0,1) 。
 *
 * 示例 3：
 * 输入：nums1 = [30,29,19,5], nums2 = [25,25,25,25,25]
 * 输出：2
 * 解释：有效下标对是 (2,2), (2,3), (2,4), (3,3) 和 (3,4) 。
 * 最大距离是 2 ，对应下标对 (2,4) 。
 *
 * 示例 4：
 * 输入：nums1 = [5,4], nums2 = [3,2]
 * 输出：0
 * 解释：不存在有效下标对，所以返回 0 。
 *  
 *
 * 提示：
 * 1 <= nums1.length <= 105
 * 1 <= nums2.length <= 105
 * 1 <= nums1[i], nums2[j] <= 105
 * nums1 和 nums2 都是 非递增 数组
 */
public class MaxDistance {
    public static void main(String[] args) {
        MaxDistance md = new MaxDistance();
        int[] nums1 = new int[] { 55, 30, 5, 4, 2 };
        int[] nums2 = new int[] { 100, 20, 10, 10, 5 };
        System.out.println(md.maxDistance(nums1, nums2));

        int[] nums13 = new int[] { 2, 2, 2 };
        int[] nums23 = new int[] { 10, 10, 1 };
        System.out.println(md.maxDistance(nums13, nums23));

        int[] nums12 = new int[] { 30, 29, 19, 5 };
        int[] nums22 = new int[] { 25, 25, 25, 25, 25 };
        System.out.println(md.maxDistance(nums12, nums22));

        int[] nums11 = new int[] { 5, 4 };
        int[] nums21 = new int[] { 3, 2 };
        System.out.println(md.maxDistance(nums11, nums21));
        int[] nums14 =
                new int[] { 10000, 9999, 9997, 9996, 9994, 9990, 9989, 9989, 9989, 9989, 9988, 9987, 9986, 9985, 9980,
                        9980, 9975, 9974, 9973, 9973, 9972, 9970, 9969, 9968, 9967, 9967, 9966, 9965, 9963, 9962, 9962,
                        9962, 9961, 9961, 9961, 9960, 9959, 9959, 9958, 9957, 9957, 9956, 9953, 9953, 9949, 9949, 9947,
                        9947, 9945, 9943, 9942, 9939, 9938, 9938, 9936, 9936, 9935, 9934, 9933, 9932, 9932, 9930, 9929,
                        9928, 9928, 9928, 9927, 9927, 9924, 9923, 9919, 9918, 9918, 9918, 9917, 9917, 9917, 9915, 9914,
                        9913, 9910, 9908, 9904, 9904, 9903, 9902, 9902, 9901, 9901, 9900, 9899, 9899, 9899, 9897, 9897,
                        9895, 9893, 9892, 9892, 9891, 9890, 9890, 9889, 9889, 9889, 9887, 9884, 9883, 9883, 9878, 9877,
                        9877, 9876, 9873, 9870, 9869, 9868, 9867, 9867, 9866, 9865, 9863, 9863, 9862, 9860, 9858, 9857,
                        9857, 9856, 9855, 9854, 9850, 9849, 9847, 9846, 9846, 9844, 9841, 9841, 9838, 9838, 9838, 9838,
                        9837, 9836, 9836, 9836, 9836, 9835, 9834, 9833, 9833, 9832, 9831, 9831, 9830, 9827, 9826, 9825,
                        9823, 9817, 9816, 9816, 9815, 9814, 9813, 9813, 9813, 9813, 9812, 9812, 9810, 9810, 9809, 9809,
                        9808, 9807, 9807, 9806, 9806, 9805, 9804, 9803, 9802, 9802, 9796, 9796, 9795, 9790, 9788, 9788,
                        9787, 9787, 9787, 9787, 9786, 9786, 9786, 9786, 9785, 9784, 9783, 9780, 9780, 9780, 9779, 9779,
                        9779, 9777, 9776, 9776, 9776, 9776, 9771, 9767, 9765, 9765, 9765, 9764, 9762, 9761, 9757, 9754,
                        9754, 9751, 9748, 9748, 9748, 9746, 9746, 9744, 9744, 9742, 9742, 9741, 9737, 9736, 9736, 9736,
                        9734, 9732, 9732, 9730, 9729, 9729, 9729, 9729, 9728, 9727, 9727, 9726, 9724, 9723, 9722, 9721,
                        9720, 9718, 9717, 9715, 9715, 9714, 9713, 9712, 9712, 9711, 9711, 9710, 9709, 9708, 9708, 9703,
                        9702, 9702, 9701, 9699, 9698, 9693, 9693, 9693, 9689, 9687, 9686, 9685, 9677, 9677, 9675, 9672,
                        9670, 9670, 9669, 9668, 9668, 9668, 9667, 9666, 9666, 9666, 9665, 9665, 9665, 9662, 9661, 9661,
                        9660, 9656, 9654, 9653, 9652, 9652, 9650, 9649, 9647, 9647, 9644, 9643, 9643, 9641, 9639, 9637,
                        9636, 9635, 9634, 9634, 9633, 9633, 9633, 9631, 9631, 9630, 9627, 9625, 9625, 9624, 9623, 9621,
                        9619, 9619, 9618, 9618, 9617, 9616, 9616, 9613, 9612, 9612, 9611, 9611, 9610, 9610, 9610, 9609,
                        9608, 9608, 9604, 9600, 9599, 9598, 9598, 9598, 9596, 9595, 9594, 9594, 9591, 9590, 9587, 9581,
                        9581, 9581, 9580, 9580, 9578, 9578, 9575, 9574, 9574, 9573, 9572, 9572, 9571, 9571, 9571, 9571,
                        9569, 9569, 9569, 9568, 9566, 9566, 9563, 9562, 9562, 9558, 9557, 9556, 9556, 9555, 9554, 9552,
                        9552, 9552, 9551, 9551, 9550, 9549, 9549, 9548, 9547, 9546, 9546, 9544, 9543, 9543, 9542, 9542,
                        9540, 9539, 9539, 9538, 9536, 9536, 9536, 9536, 9534, 9533, 9532, 9531, 9530, 9528, 9528, 9528,
                        9527, 9527, 9526, 9525, 9524, 9522, 9521, 9520, 9519, 9518, 9517, 9517, 9515, 9512, 9511, 9510,
                        9509, 9506, 9505, 9504, 9503, 9503, 9502, 9501, 9501, 9499, 9499, 9499, 9498, 9498, 9497, 9496,
                        9495, 9494, 9494, 9493, 9493, 9491, 9491, 9491, 9491, 9491, 9490, 9490, 9488, 9488, 9487, 9485,
                        9485, 9485, 9485, 9481, 9480, 9480, 9480, 9480, 9479, 9478, 9477, 9476, 9475, 9470, 9469, 9468,
                        9468, 9467, 9467, 9466, 9466, 9466, 9463, 9462, 9462, 9461, 9460, 9460, 9458, 9456, 9455, 9455,
                        9455, 9454, 9453, 9452, 9451, 9450, 9450, 9450, 9449, 9449, 9448, 9448, 9448, 9446, 9443, 9442,
                        9440, 9438, 9438, 9436, 9436, 9435, 9435, 9434, 9434, 9434, 9433, 9432, 9432, 9432, 9429, 9429,
                        9429, 9427, 9426, 9424, 9423, 9423, 9422, 9421, 9419, 9419, 9418, 9418, 9418, 9417, 9417, 9413,
                        9413, 9412, 9411, 9410, 9408, 9408, 9406, 9406, 9405, 9404, 9404, 9401, 9400, 9400, 9400, 9399,
                        9398, 9397, 9396, 9396, 9395, 9395, 9395, 9393, 9393, 9391, 9391, 9390, 9390, 9390, 9389, 9388,
                        9386, 9386, 9386, 9385, 9381, 9380, 9379, 9379, 9377, 9376, 9375, 9375, 9374, 9374, 9373, 9373,
                        9373, 9372, 9372, 9371, 9370, 9370, 9367, 9366, 9366, 9366, 9366, 9365, 9365, 9365, 9364, 9362,
                        9362, 9360, 9360, 9359, 9356, 9356, 9355, 9355, 9353, 9352, 9351, 9349, 9346, 9344, 9344, 9342,
                        9342, 9341, 9340, 9339, 9339, 9336, 9335, 9335, 9334, 9333, 9332, 9331, 9331, 9329, 9327, 9326,
                        9323, 9322, 9320, 9319, 9319, 9319, 9318, 9318, 9317, 9317, 9317, 9315, 9315, 9315, 9314, 9314,
                        9314, 9313, 9311, 9311, 9310, 9310, 9309, 9308, 9307, 9306, 9305, 9304, 9303, 9301, 9296, 9296,
                        9294, 9293, 9293, 9292, 9286, 9286, 9282, 9281, 9281, 9280, 9279, 9279, 9277, 9277, 9277, 9276,
                        9275, 9275, 9275, 9274, 9272, 9272, 9269, 9268, 9266, 9266, 9266, 9265, 9264, 9264, 9262, 9260,
                        9259, 9259, 9258, 9257, 9255, 9254, 9254, 9254, 9251, 9250, 9250, 9249, 9248, 9246, 9239, 9236,
                        9234, 9234, 9232, 9231, 9229, 9228, 9226, 9225, 9224, 9224, 9223, 9221, 9221, 9216, 9215, 9214,
                        9214, 9212, 9210, 9207, 9207, 9206, 9205, 9204, 9204, 9202, 9202, 9201, 9200, 9195, 9195, 9195,
                        9195, 9194, 9193, 9193, 9192, 9187, 9183, 9183, 9177, 9177, 9176, 9174, 9173, 9173, 9173, 9172,
                        9171, 9169, 9168, 9166, 9165, 9164, 9161, 9157, 9157, 9155, 9155, 9154, 9153, 9153, 9151, 9151,
                        9150, 9150, 9148, 9145, 9142, 9141, 9139, 9139, 9137, 9135, 9135, 9135, 9134, 9133, 9132, 9128,
                        9126, 9126, 9126, 9124, 9123, 9123, 9122, 9122, 9120, 9120, 9119, 9116, 9115, 9113, 9110, 9109,
                        9107, 9107, 9107, 9107, 9106, 9106, 9104, 9102, 9100, 9099, 9098, 9097, 9095, 9091, 9090, 9090,
                        9088, 9087, 9086, 9086, 9085, 9084, 9081, 9077, 9076, 9076, 9073, 9072, 9072, 9071, 9071, 9071,
                        9070, 9069, 9069, 9069, 9068, 9068, 9066, 9065, 9065, 9064, 9063, 9058, 9057, 9056, 9055, 9055,
                        9054, 9052, 9052, 9052, 9049, 9046, 9045, 9045, 9044, 9042, 9042, 9041, 9040, 9040, 9039, 9039,
                        9038, 9038, 9038, 9037, 9033, 9031, 9031, 9031, 9028, 9028, 9028, 9026, 9026, 9026, 9023, 9022,
                        9022, 9020, 9019, 9018, 9018, 9018, 9017, 9014, 9011, 9009, 9008, 9008, 9007, 9006, 9004, 9004,
                        9003, 9003, 9002, 9000, 8996, 8995, 8990, 8989, 8986, 8984, 8983, 8981, 8981, 8980, 8980, 8978,
                        8978, 8977, 8977, 8976, 8976, 8972, 8969, 8969, 8966, 8965, 8964, 8962, 8960, 8959, 8958, 8956,
                        8954, 8954, 8954, 8953, 8953, 8950, 8950, 8950, 8947, 8947, 8946, 8946, 8946, 8946, 8940, 8938,
                        8938, 8938, 8935, 8934, 8933, 8932, 8931, 8930, 8930, 8930, 8929, 8927, 8926, 8924, 8924, 8922,
                        8921, 8921, 8921, 8920, 8920, 8917, 8915, 8915, 8913, 8913, 8912, 8912, 8910, 8910, 8909, 8909,
                        8908, 8907, 8907, 8906, 8904, 8903, 8903, 8902, 8899, 8897, 8896, 8895, 8894, 8892, 8891, 8891,
                        8889, 8887, 8886, 8886, 8883, 8880, 8880, 8879, 8878, 8878, 8876, 8875, 8875, 8873, 8873, 8871,
                        8868, 8868, 8867, 8866, 8866, 8865, 8864, 8863, 8859, 8858, 8858, 8858, 8858, 8858, 8857, 8856,
                        8856, 8854, 8854, 8853, 8852, 8850, 8849, 8847, 8846, 8844, 8843, 8841, 8839, 8838, 8837, 8837,
                        8836, 8835, 8834, 8833, 8833, 8832, 8831, 8830, 8830, 8828, 8827, 8826, 8825, 8824, 8823, 8823,
                        8823, 8822, 8820, 8817, 8814, 8814, 8812, 8810, 8810, 8809, 8808, 8804, 8802, 8801, 8799, 8798,
                        8797, 8794, 8794, 8793, 8792, 8792, 8791, 8785, 8784, 8783, 8783, 8783, 8781, 8780, 8780, 8778,
                        8776, 8776, 8776, 8773, 8772, 8771, 8771, 8770, 8770, 8770, 8769, 8768, 8767, 8766, 8765, 8765,
                        8764, 8760, 8758, 8755, 8755, 8754, 8754, 8753, 8751, 8750, 8750, 8748, 8747, 8746, 8746, 8745,
                        8744, 8742, 8738, 8737, 8736, 8736, 8736, 8736, 8735, 8733, 8733, 8732, 8732, 8729, 8729, 8728,
                        8728, 8727, 8727, 8726, 8724, 8724, 8724, 8723, 8723, 8723, 8722, 8721, 8721, 8721, 8716, 8715,
                        8713, 8713, 8711, 8708, 8706, 8706, 8705, 8705, 8705, 8703, 8703, 8701, 8700, 8696, 8695, 8693,
                        8693, 8692, 8691, 8691, 8690, 8689, 8687, 8687, 8687, 8687, 8687, 8686, 8685, 8685, 8685, 8684,
                        8684, 8684, 8683, 8683, 8679, 8678, 8678, 8677, 8675, 8672, 8671, 8669, 8669, 8668, 8667, 8666,
                        8665, 8665, 8664, 8662, 8660, 8660, 8659, 8658, 8657, 8657, 8656, 8656, 8655, 8654, 8652, 8651,
                        8651, 8649, 8646, 8644, 8643, 8641, 8640, 8637, 8637, 8634, 8633, 8631, 8631, 8630, 8629, 8627,
                        8626, 8626, 8624, 8624, 8624, 8621, 8621, 8620, 8617, 8617, 8617, 8616, 8614, 8614, 8613, 8610,
                        8610, 8609, 8608, 8607, 8605, 8605, 8605, 8603, 8602, 8602, 8600, 8597, 8597, 8596, 8596, 8594,
                        8593, 8593, 8592, 8588, 8586, 8584, 8583, 8582, 8579, 8579, 8579, 8578, 8577, 8575, 8575, 8572,
                        8572, 8572, 8571, 8571, 8569, 8568, 8568, 8567, 8566, 8566, 8566, 8565, 8565, 8565, 8562, 8562,
                        8561, 8557, 8555, 8552, 8552, 8550, 8550, 8546, 8546, 8544, 8543, 8543, 8542, 8540, 8540, 8539,
                        8539, 8536, 8535, 8534, 8534, 8533, 8528, 8528, 8528, 8526, 8520, 8519, 8519, 8519, 8519, 8517,
                        8516, 8516, 8512, 8510, 8510, 8508, 8508, 8506, 8506, 8505, 8504, 8503, 8501, 8498, 8497, 8496,
                        8494, 8493, 8492, 8491, 8491, 8489, 8487, 8486, 8485, 8485, 8484, 8484, 8484, 8483, 8483, 8482,
                        8482, 8482, 8478, 8477, 8477, 8477, 8477, 8476, 8475, 8474, 8474, 8473, 8472, 8472, 8471, 8471,
                        8470, 8470, 8470, 8469, 8467, 8467, 8466, 8466, 8463, 8463, 8463, 8462, 8461, 8460, 8459, 8452,
                        8451, 8451, 8451, 8449, 8449, 8447, 8444, 8443, 8443, 8442, 8442, 8438, 8436, 8434, 8434, 8432,
                        8430, 8428, 8428, 8428, 8427, 8423, 8423, 8421, 8420, 8417, 8417, 8416, 8413, 8412, 8412, 8412,
                        8411, 8408, 8407, 8406, 8405, 8401, 8399, 8398, 8398, 8397, 8397, 8396, 8395, 8394, 8393, 8393,
                        8392, 8390, 8390, 8389, 8388, 8388, 8385, 8383, 8382, 8382, 8381, 8380, 8379, 8378, 8374, 8373,
                        8370, 8369, 8366, 8365, 8365, 8365, 8365, 8363, 8362, 8362, 8359, 8358, 8356, 8356, 8355, 8354,
                        8354, 8354, 8353, 8353, 8352, 8352, 8352, 8352, 8350, 8349, 8348, 8347, 8347, 8347, 8346, 8343,
                        8342, 8341, 8339, 8338, 8338, 8337, 8337, 8337, 8336, 8336, 8336, 8334, 8333, 8332, 8332, 8330,
                        8330, 8327, 8326, 8325, 8325, 8324, 8324, 8324, 8323, 8320, 8320, 8317, 8317, 8317, 8316, 8316,
                        8316, 8315, 8314, 8313, 8312, 8312, 8310, 8309, 8309, 8307, 8307, 8304, 8304, 8303, 8302, 8301,
                        8298, 8298, 8297, 8295, 8295, 8294, 8294, 8293, 8293, 8292, 8291, 8289, 8288, 8288, 8287, 8287,
                        8286, 8286, 8285, 8282, 8281, 8280, 8278, 8277, 8276, 8276, 8275, 8274, 8274, 8273, 8273, 8273,
                        8272, 8270, 8269, 8267, 8265, 8262, 8261, 8257, 8257, 8256, 8255, 8253, 8253, 8251, 8250, 8248,
                        8248, 8248, 8247, 8245, 8244, 8243, 8242, 8242, 8241, 8241, 8240, 8239, 8237, 8236, 8234, 8234,
                        8233, 8232, 8232, 8230, 8229, 8228, 8227, 8227, 8224, 8223, 8222, 8221, 8219, 8219, 8219, 8218,
                        8218, 8217, 8214, 8213, 8213, 8213, 8212, 8211, 8208, 8207, 8207, 8205, 8203, 8203, 8202, 8202,
                        8200, 8197, 8195, 8195, 8193, 8192, 8191, 8191, 8189, 8188, 8187, 8186, 8185, 8185, 8184, 8184,
                        8182, 8182, 8180, 8179, 8178, 8178, 8176, 8174, 8173, 8171, 8171, 8170, 8169, 8168, 8165, 8164,
                        8162, 8162, 8161, 8161, 8160, 8157, 8156, 8155, 8153, 8153, 8153, 8153, 8153, 8152, 8151, 8150,
                        8146, 8144, 8141, 8140, 8138, 8135, 8135, 8135, 8133, 8130, 8129, 8127, 8127, 8127, 8127, 8126,
                        8125, 8124, 8124, 8124, 8123, 8123, 8122, 8121, 8121, 8119, 8119, 8117, 8117, 8117, 8116, 8116,
                        8114, 8114, 8114, 8108, 8108, 8105, 8105, 8104, 8103, 8103, 8103, 8101, 8100, 8097, 8095, 8094,
                        8093, 8091, 8091, 8091, 8088, 8086, 8083, 8083, 8080, 8079, 8078, 8078, 8076, 8076, 8076, 8075,
                        8075, 8075, 8074, 8073, 8073, 8072, 8070, 8069, 8069, 8067, 8067, 8067, 8067, 8066, 8065, 8063,
                        8062, 8061, 8061, 8059, 8057, 8056, 8053, 8052, 8048, 8043, 8043, 8043, 8043, 8041, 8039, 8039,
                        8039, 8038, 8038, 8036, 8036, 8034, 8032, 8032, 8031, 8030, 8027, 8025, 8024, 8024, 8022, 8020,
                        8020, 8019, 8016, 8015, 8014, 8013, 8013, 8012, 8012, 8010, 8010, 8009, 8009, 8008, 8008, 8007,
                        8007, 8006, 8006, 8006, 8006, 8006, 8004, 8003, 8002, 7999, 7999, 7998, 7996, 7994, 7993, 7988,
                        7983, 7980, 7977, 7977, 7976, 7975, 7974, 7969, 7967, 7966, 7965, 7965, 7964, 7963, 7962, 7962,
                        7961, 7961, 7961, 7960, 7960, 7960, 7958, 7957, 7957, 7956, 7956, 7955, 7952 };
        String str = args[0];
        String[] s = str.split(",");
        int[] nums24 = new int[s.length];
        for (int i = 0; i < s.length; i++) {
            nums24[i] = Integer.parseInt(s[i]);
        }
        System.out.println(md.maxDistance(nums14, nums24));
        System.out.println(md.maxDistanceI(nums14, nums24));
    }

    public int maxDistanceI(int[] nums1, int[] nums2) {
        int n = nums1.length, m = nums2.length;
        int i = 0, res = 0;
        for (int j = 0; j < m; ++j) {
            while (i < n && nums1[i] > nums2[j]) {
                ++i;
            }
            if (i < n) {
                res = Math.max(res, j - i);
            }
        }
        return res;
    }

    public int maxDistance(int[] nums1, int[] nums2) {
        int n = nums1.length, m = nums2.length;
        int i = n - 1;
        int cnt = 0;
        for (int j = m - 1; j >= 0; j--) {
            while (i > 0 && nums2[j] >= nums1[i] && nums2[j] >= nums1[i - 1]) {
                i--;
            }
            if (nums2[j] >= nums1[i]) {
                int curCnt = j - i;
                if (cnt < curCnt) {
                    cnt = curCnt;
                }
            }
        }
        return cnt;
    }
}
